<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>üë• Usuaris Oracle</title>
  <link rel="stylesheet" href="estilsunitats.css">

</head>
<body>

<header>
  <a href="index.html">
  <img src="https://upload.wikimedia.org/wikipedia/commons/5/50/Oracle_logo.svg" alt="Oracle Logo">
</a>
  <h1>ASGBD   -    Usuaris i Permisos en Oracle</h1>
</header>

<nav>
  <h3>√çndex</h3>
  <a href="#usuaris">Usuaris en ORACLE</a>
  <a href="#permisos">Permisos o Privilegis</a>
  <a href="#rols">Rols en ORACLE</a>
  <a href="#perfils">Perfils en ORACLE</a>
  <a href="#esquemes">Esquemes externs</a>
</nav>

<main>
  
  <section id="usuaris">
    <h2>üë§ Usuaris en Oracle</h2>
  
    <h3> Qu√® √©s un usuari?</h3>
    <p>Un <strong>usuari Oracle</strong> identifica una entitat que accedeix a la base de dades. Pot representar una persona, aplicaci√≥ o proc√©s.</p>
    <p>Quan es crea un usuari, tamb√© es crea autom√†ticament el seu <strong>esquema</strong> (schema), que cont√© els seus objectes: taules, vistes, procediments, etc.</p>
  
    <h3>üîê Autenticaci√≥ d'usuaris</h3>
    <ul>
      <li><strong>Local</strong>: usuari amb credencials dins de la base de dades</li>
      <li><strong>Extern</strong>: validaci√≥ per S.O., LDAP, Kerberos, Radius</li>
      <li><strong>Global</strong>: autenticaci√≥ empresarial o federada (Oracle Enterprise User Security)</li>
      <li><strong>Schema-only</strong>: no necessita contrasenya (nom√©s objectes)</li>
    </ul>
  
    <h3> Tipus d'usuaris</h3>
    <ul>
      <li><strong>Predefinits</strong>: SYS, SYSTEM, SYSBACKUP, etc. (evitar-ne l'√∫s directe si no √©s estrictament necessari)</li>
      <li><strong>Comuns</strong>: disponibles a totes les PDBs (requereixen prefix <code>C##</code>)</li>
      <li><strong>Locals</strong>: definits dins d‚Äôuna PDB concreta</li>
    </ul>
  
    <h3> Creaci√≥, modificaci√≥ i baixa d'usuaris</h3>
    <pre>
  -- Crear usuari local
  CREATE USER joan IDENTIFIED BY '1234';
  
  -- Crear usuari com√∫ (en CDB)
  CREATE USER C##admin IDENTIFIED BY 'secure' CONTAINER=ALL;
  
  -- Modificar contrasenya
  ALTER USER joan IDENTIFIED BY 'nova_clau';
  
  -- Eliminar usuari
  DROP USER joan CASCADE;
    </pre>
  
    <h3> Atributs addicionals en la creaci√≥</h3>
    <pre>
  CREATE USER enric IDENTIFIED BY secret
  DEFAULT TABLESPACE users
  TEMPORARY TABLESPACE temp
  QUOTA UNLIMITED ON users
  PROFILE default;
    </pre>
  
    <h3>üîë Donar permisos de connexi√≥</h3>
    <p>Un usuari no pot connectar si no t√© el privilegi <code>CREATE SESSION</code>:</p>
    <pre>GRANT CREATE SESSION TO joan;</pre>
  
    <h3> Estats dels comptes</h3>
    <ul>
      <li> Obert</li>
      <li> Bloquejat</li>
      <li> Expirat</li>
      <li> Expirat en per√≠ode de gr√†cia</li>
    </ul>
  
    <h4>Exemples de gesti√≥:</h4>
    <pre>
  ALTER USER joan ACCOUNT LOCK;
  ALTER USER joan ACCOUNT UNLOCK;
  ALTER USER joan PASSWORD EXPIRE;
    </pre>
  
    <h3>üîç Consultes √∫tils</h3>
    <pre>
  -- Usuaris existents
  SELECT username, account_status FROM dba_users;
  
  -- Esquema actiu
  SELECT user FROM dual;
  
  -- Par√†metres d‚Äôusuaris administratius
  SELECT * FROM v$pwfile_users;
    </pre>
  
    <h3> Notes importants</h3>
    <ul>
      <li> No es poden crear usuaris directament a <code>CDB$ROOT</code> sense permisos especials</li>
      <li> Un usuari pot tindre <strong>un √∫nic perfil</strong> i m√∫ltiples <strong>rols i privilegis</strong></li>
      <li> S'ha de donar quota d'espai per a crear objectes</li>
    </ul>
  
    <h3> Exemple complet: usuari operatiu</h3>
    <pre>
  CREATE USER enric IDENTIFIED BY secret
  DEFAULT TABLESPACE tab_app
  QUOTA UNLIMITED ON tab_app
  PASSWORD EXPIRE;
  
  GRANT CONNECT, RESOURCE TO enric;
    </pre>
  
    <h3>üí¨ Autenticaci√≥ en multitenant (CDB/PDB)</h3>
    <ul>
      <li>SYS nom√©s pot accedir amb <code>AS SYSDBA</code></li>
      <li>Es recomana accedir a les PDBs amb usuaris locals</li>
    </ul>
  
    <pre>
  -- Connexi√≥ com SYSTEM a PDB1
  sqlplus system@localhost/pdb1
    </pre>
  
    <h3> Vistes relacionades amb usuaris</h3>
    <ul>
      <li><code>DBA_USERS</code></li>
      <li><code>V$PWFILE_USERS</code></li>
      <li><code>USER_USERS</code></li>
      <li><code>SESSION_USERS</code></li>
    </ul>
  
    <h3> Bones pr√†ctiques</h3>
    <ul>
      <li> Canviar contrasenyes predefinides</li>
      <li> No usar SYS o SYSTEM per a operacions del dia a dia</li>
      <li> Crear un tablespace separat per a cada aplicaci√≥/usuari</li>
      <li> Utilitzar rols i perfils per gestionar permisos i restriccions</li>
    </ul>
  </section>
  


  <section id="permisos">
    <h2>üîê Permisos en Oracle</h2>
  
    <h3> Qu√® s√≥n els permisos (privilegis)?</h3>
    <p>
      Els <strong>permisos</strong> o <strong>privilegis</strong> s√≥n drets que Oracle atorga als usuaris per fer determinades accions sobre la base de dades: 
      accedir, modificar, crear, administrar objectes o usuaris.
    </p>
  
    <h3> Tipus de permisos</h3>
    <ul>
      <li><strong>Privilegis de sistema</strong>: permeten executar accions globals (crear taules, accedir a sessions...)</li>
      <li><strong>Privilegis d‚Äôobjecte</strong>: permeten accedir o modificar objectes concrets (taules, vistes...)</li>
    </ul>
  
    <h4> Exemples de privilegis de sistema</h4>
    <ul>
      <li><code>CREATE SESSION</code> ‚Üí accedir a Oracle</li>
      <li><code>CREATE TABLE</code> ‚Üí crear taules</li>
      <li><code>UNLIMITED TABLESPACE</code> ‚Üí √∫s il¬∑limitat d‚Äôespai</li>
    </ul>
  
    <h4> Exemples de privilegis d‚Äôobjecte</h4>
    <ul>
      <li><code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code> sobre taules</li>
      <li><code>EXECUTE</code> sobre procediments i funcions</li>
    </ul>
  
    <h3> Assignaci√≥ de privilegis</h3>
    <pre>
  -- Sistema
  GRANT CREATE SESSION TO joan;
  
  -- Objecte
  GRANT SELECT, INSERT ON alumnes TO joan;
    </pre>
  
    <h3>‚ôªÔ∏è Revocar permisos</h3>
    <pre>
  -- Sistema
  REVOKE CREATE SESSION FROM joan;
  
  -- Objecte
  REVOKE INSERT ON alumnes FROM joan;
    </pre>
  
    <h3>üåê Propagaci√≥ amb GRANT OPTION</h3>
    <p>Permet que un usuari que ha rebut un privilegi el pugui concedir a un altre:</p>
    <pre>
  GRANT SELECT ON alumnes TO joan WITH GRANT OPTION;
    </pre>
  
    <h3>üëÄ Consultes √∫tils</h3>
    <pre>
  -- Privilegis de sistema atorgats
  SELECT * FROM dba_sys_privs WHERE grantee = 'JOAN';
  
  -- Privilegis d‚Äôobjecte
  SELECT * FROM dba_tab_privs WHERE grantee = 'JOAN';
  
  -- Qu√® puc fer?
  SELECT * FROM session_privs;
    </pre>
  
    <h3>üß™ Exemple pr√†ctic</h3>
    <pre>
  -- Crear usuari i donar acc√©s b√†sic
  CREATE USER marta IDENTIFIED BY 1234;
  GRANT CREATE SESSION, CREATE TABLE TO marta;
  
  -- Permetre a marta consultar alumnes
  GRANT SELECT ON alumnes TO marta;
    </pre>
  
    <h3>Consideracions importants</h3>
    <ul>
      <li> Els privilegis de sistema s√≥n molt potents: assigna nom√©s els necessaris</li>
      <li> Els privilegis d‚Äôobjecte poden donar-se amb m√©s flexibilitat</li>
      <li> No utilitzis <code>GRANT ALL</code> llevat que sigui imprescindible</li>
      <li> Revisa i revoca privilegis regularment</li>
    </ul>
  
    <h3>üìò Bones pr√†ctiques</h3>
    <ul>
      <li> Usa rols per agrupar permisos (veurem a la seg√ºent secci√≥)</li>
      <li> Documenta qu√® rep cada usuari i per qu√®</li>
      <li> Monitoritza qui t√© permisos amb consultes sobre el diccionari de dades</li>
    </ul>
  </section>
  

  <section id="rols">
    <h2>üé≠ Rols en Oracle</h2>
  
    <h3> Qu√® √©s un rol?</h3>
    <p>
      Un <strong>rol</strong> √©s un conjunt de permisos agrupats sota un nom. Serveix per simplificar la gesti√≥ de privilegis, especialment en entorns amb molts usuaris.
    </p>
    <p>En comptes d‚Äôassignar 10 permisos a cada usuari, es crea un rol amb aquests permisos i s‚Äôassigna el rol.</p>
  
    <h3> Tipus de rols</h3>
    <ul>
      <li><strong>Predefinits</strong> (creats per Oracle): <code>DBA</code>, <code>CONNECT</code>, <code>RESOURCE</code>, <code>SELECT_CATALOG_ROLE</code>, etc.</li>
      <li><strong>Definits per l‚Äôusuari</strong>: creats per l‚Äôadministrador segons les necessitats espec√≠fiques</li>
      <li><strong>Rols actius/inactius</strong>: en una sessi√≥ es poden activar o desactivar rols</li>
    </ul>
  
    <h3>üõ†Ô∏è Crear i assignar rols</h3>
    <pre>
  -- Crear un nou rol
  CREATE ROLE gestor_aula;
  
  -- Concedir permisos al rol
  GRANT CREATE SESSION, CREATE TABLE TO gestor_aula;
  
  -- Assignar el rol a un usuari
  GRANT gestor_aula TO marta;
    </pre>
  
    <h3> Revocar rols</h3>
    <pre>
  REVOKE gestor_aula FROM marta;
    </pre>
  
    <h3> Activar i desactivar rols</h3>
    <p>Un usuari pot tenir diversos rols assignats, per√≤ nom√©s alguns poden estar actius a la vegada.</p>
    <pre>
  -- Activar un rol espec√≠fic
  SET ROLE gestor_aula;
  
  -- Activar tots els rols per defecte
  SET ROLE ALL;
  
  -- Desactivar tots els rols
  SET ROLE NONE;
    </pre>
  
    <h3>üîç Consultes √∫tils</h3>
    <pre>
  -- Rols assignats a un usuari
  SELECT * FROM dba_role_privs WHERE grantee = 'MARTA';
  
  -- Rols definits al sistema
  SELECT * FROM dba_roles;
  
  -- Privilegis d‚Äôun rol
  SELECT * FROM role_sys_privs WHERE role = 'GESTOR_AULA';
    </pre>
  
    <h3> Exemple pr√†ctic complet</h3>
    <pre>
  CREATE ROLE aplicacio_web;
  
  GRANT CREATE SESSION TO aplicacio_web;
  GRANT SELECT, INSERT, UPDATE ON alumnes TO aplicacio_web;
  
  CREATE USER webapp IDENTIFIED BY secret;
  GRANT aplicacio_web TO webapp;
    </pre>
  
    <h3> Bones pr√†ctiques</h3>
    <ul>
      <li> Agrupa privilegis per rols segons la funcionalitat (ex: lectura, administraci√≥, desenvolupament)</li>
      <li> Documenta qu√® fa cada rol i qui l‚Äôha de tenir</li>
      <li> No afegeixis <code>ALL PRIVILEGES</code> dins d‚Äôun rol sense motiu justificat</li>
      <li> Usa rols en lloc de donar permisos individuals sempre que sigui possible</li>
    </ul>
  </section>
  

  <section id="perfils">
    <h2>Perfils en Oracle</h2>
  
    <h3> Qu√® √©s un perfil?</h3>
    <p>
      En Oracle, un <strong>perfil</strong> √©s un conjunt de restriccions i par√†metres que s‚Äôapliquen als usuaris de la base de dades. 
      Aquests par√†metres permeten controlar l‚Äô√∫s de recursos del sistema (com el nombre m√†xim de sessions, temps connectat, etc.) i establir pol√≠tiques de seguretat sobre les contrasenyes.
    </p>
  
    <h3> Par√†metres de recursos</h3>
    <p>
      Els par√†metres de recursos limiten l‚Äô√∫s que pot fer un usuari del sistema. Alguns dels m√©s comuns s√≥n:
    </p>
    <ul>
      <li><strong>SESSIONS_PER_USER</strong>: N√∫mero m√†xim de sessions que pot tenir un usuari.</li>
      <li><strong>CONNECT_TIME</strong>: Temps m√†xim de connexi√≥ per sessi√≥ (en minuts).</li>
      <li><strong>IDLE_TIME</strong>: Temps m√†xim que un usuari pot estar inactiu abans de ser desconnectat.</li>
      <li><strong>CPU_PER_SESSION</strong> i <strong>CPU_PER_CALL</strong>: L√≠mit de CPU (en cent√®simes de segon).</li>
      <li><strong>LOGICAL_READS_PER_SESSION</strong> i <strong>LOGICAL_READS_PER_CALL</strong>: L√≠mit de lectures l√≤giques en blocs.</li>
    </ul>
  
    <h3> Par√†metres de contrasenya</h3>
    <p>
      Els par√†metres de contrasenya ajuden a refor√ßar la seguretat dels usuaris, control¬∑lant aspectes com:
    </p>
    <ul>
      <li><strong>FAILED_LOGIN_ATTEMPTS</strong>: Nombre d'intents fallits d'autenticaci√≥ abans de bloquejar el compte.</li>
      <li><strong>PASSWORD_LIFE_TIME</strong>: Durada de la contrasenya abans que expiri (en dies).</li>
      <li><strong>PASSWORD_REUSE_TIME</strong>: Temps m√≠nim que s'ha d'esperar per reutilitzar una contrasenya.</li>
      <li><strong>PASSWORD_REUSE_MAX</strong>: Nombre m√†xim de vegades que es pot reutilitzar la contrasenya.</li>
      <li><strong>PASSWORD_LOCK_TIME</strong>: Temps de bloqueig del compte despr√©s de superar els intents fallits.</li>
      <li><strong>PASSWORD_GRACE_TIME</strong>: Per√≠ode de gr√†cia en qu√® l'usuari pot canviar la contrasenya despr√©s que hagi expirat.</li>
      <li><strong>PASSWORD_VERIFY_FUNCTION</strong>: Funci√≥ de verificaci√≥ de contrasenyes per aplicar pol√≠tiques de complexitat.</li>
    </ul>
  
    <h3> Crear i modificar perfils</h3>
    <p>Pots crear un perfil nou amb la comanda <code>CREATE PROFILE</code> i modificar-lo amb <code>ALTER PROFILE</code>.</p>
    <pre>
  -- Exemple de creaci√≥ d'un perfil amb restriccions de recursos i contrasenya
  CREATE PROFILE perf-adm LIMIT
    SESSIONS_PER_USER     5
    CONNECT_TIME          120
    IDLE_TIME             30
    FAILED_LOGIN_ATTEMPTS 4
    PASSWORD_LIFE_TIME    165;
  
  -- Modificar un perfil per establir un temps de bloqueig de la contrasenya
  ALTER PROFILE perf-adm LIMIT PASSWORD_LOCK_TIME 5;
    </pre>
  
    <h3> Assignar un perfil a un usuari</h3>
    <p>En crear o modificar un usuari, pots assignar-li un perfil per limitar els recursos i aplicar pol√≠tiques de seguretat:</p>
    <pre>
  -- Crear un usuari amb un perfil espec√≠fic
  CREATE USER enric IDENTIFIED BY secret
    DEFAULT TABLESPACE tab_app
    QUOTA UNLIMITED ON tab_app
    PROFILE perf-adm;
  
  -- O actualitzar un usuari existent per assignar-li un perfil
  ALTER USER enric PROFILE perf-adm;
    </pre>
  
    <h3> Bones pr√†ctiques</h3>
    <ul>
      <li>Assigna perfils adaptats a la naturalesa dels usuaris (admins, desenvolupadors, operatius, etc.).</li>
      <li>Revisa peri√≤dicament els par√†metres de recursos i contrasenya per garantir un equilibri entre rendiment i seguretat.</li>
      <li>Assegura‚Äôt que els usuaris amb privilegis elevats tinguin pol√≠tiques de seguretat m√©s estrictes.</li>
      <li>Utilitza el perfil DEFAULT com a punt de partida i modifica els par√†metres segons les necessitats espec√≠fiques.</li>
    </ul>
  
    <h3>üîç Consultes √∫tils relacionades amb perfils</h3>
    <pre>
  -- Consultar els perfils definit per la base de dades
  SELECT * FROM dba_profiles ORDER BY profile;
  
  -- Consultar par√†metres de tipus PASSWORD en el perfil DEFAULT
  SELECT * FROM dba_profiles WHERE resource_type = 'PASSWORD';
  
  -- Consultar usuaris i els seus perfils
  SELECT username, profile FROM dba_users;
    </pre>
    
    <h3> Resum</h3>
    <p>
      Els perfils en Oracle s√≥n eines fonamentals per controlar l‚Äô√∫s dels recursos i refor√ßar la seguretat dels comptes d‚Äôusuaris. 
      Mitjan√ßant la creaci√≥, modificaci√≥ i assignaci√≥ de perfils, es pot garantir que els usuaris compleixin amb les pol√≠tiques establertes, 
      tot assegurant un rendiment √≤ptim i la protecci√≥ de la base de dades.
    </p>
  </section>
  


</main>

<script>

// Per poder copiar codi en el porta-retalls. S'ha de posar un bot√≥ en cada <pre>
      //  <div class="pre-container">
      //    <button class="copy-button">Copia Codi !</button>
  document.addEventListener('DOMContentLoaded', function () {
    const buttons = document.querySelectorAll('.copy-button');

    buttons.forEach(button => {
      button.addEventListener('click', function () {
        const code = this.nextElementSibling.innerText;
        navigator.clipboard.writeText(code).then(() => {
          this.innerText = ' ‚úî Copiat!';
          setTimeout(() => this.innerText = 'Copia Codi !', 3000);
        });
      });
    });
  });

</script>

</body>
</html>
