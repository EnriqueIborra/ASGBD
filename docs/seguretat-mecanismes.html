<!DOCTYPE html>
<html lang="ca">
<head>
  <meta charset="UTF-8">
  <title>üîí Seguretat Oracle</title>
  <link rel="stylesheet" href="estilsunitats.css">
  <link rel="stylesheet" href="https://cdn.hugeicons.com/font/hgi-stroke-rounded.css" />

</head>
<body>

<header>
  <a href="index.html">
    <!--<img src="https://upload.wikimedia.org/wikipedia/commons/5/50/Oracle_logo.svg" alt="Oracle Logo"> -->
    <img src="imgs/ASGBD.png" alt="M√≤dul ASGBD">
</a>
  <h1>ASGBD   -    Mecanismes de Seguretat</h1>
</header>

<nav class="segu">
  <h3>√çndex</h3>
  <a href="#encripta">Encriptaci√≥ en  ORACLE</a>
  <a href="#auditoria">Auditoria en ORACLE</a>
  <a href="#integritat">Integritat</a>
  <a href="#transaccions">Transaccions (TCL)</a>
  <a href="#backups">Backups</a>
  <a href="#normativa-vigent">Normativa vigent</a>
  <a href="#altres-recursos">Altres Recursos</a>
</nav>

<main>
     
    <section id="encripta">
    <h2>üîê Encriptaci√≥ en Oracle</h2>

    <h3> Qu√® √©s i per qu√® encriptar?</h3>
    <p>L‚Äôencriptaci√≥ converteix dades llegibles en format codificat (xifrat) que nom√©s pot ser desxifrat amb una clau. √âs essencial per protegir informaci√≥ sensible.</p>
    <p>Una altra manera d'encriptar √©s fer un HASH (Hashing). Objectiu: generar una empremta √∫nica i irreversible d‚Äôun text.
      √ös t√≠pic: Guardar contrasenyes de forma segura,  Verificar integritat de fitxers, Firmes digitals.
    </p>

    <h4> Raons per aplicar encriptaci√≥:</h4>
    <ul>
        <li>Protecci√≥ de dades sensibles (DNI, contrasenyes...)</li>
        <li>Evitar robatori de dades en cas d‚Äôatac o acc√©s indegut</li>
        <li>Compliment legal (RGPD, LOPDGDD)</li>
        <li>Requisits de seguretat corporativa o governamental (CCN-CERT)</li>
    </ul>

    <h4>‚ö†Ô∏è Possibles inconvenients:</h4>
    <ul>
        <li>Rendiment redu√Øt si s‚Äôusa massivament</li>
        <li>Augment de complexitat en la gesti√≥</li>
        <li>Pot limitar compatibilitats amb aplicacions</li>
    </ul>

    <h3>üõ†Ô∏è Tipus d‚Äôencriptaci√≥ a Oracle</h3>
    <ul>
        <li><strong>Manual amb DBMS_CRYPTO</strong>: per programadors o xifrat personalitzat</li>
        <li><strong>TDE (Transparent Data Encryption)</strong>: xifrat autom√†tic per columnes o tablespaces</li>
    </ul>

    <h3> DBMS_CRYPTO (manual)</h3>
    <p>Paquet per fer xifrat, hash i autenticaci√≥.</p>
    <ul>
        <li><code>DBMS_CRYPTO.ENCRYPT()</code> / <code>DECRYPT()</code></li>
        <li><code>STANDARD_HASH</code></li>
        <li><code>DBMS_CRYPTO.HASH()</code></li>
    </ul>

    <h4> Exemple: fer un hash SHA-1 d‚Äôuna contrasenya</h4>
    <p>(Les funcions HASH no xifren, sols resumeixen. No es poden desxifrar)</p>
    <pre><code>SELECT STANDARD_HASH('contrasenya', 'SHA1') FROM dual;   --molt d√®bil actualment  
-- altre tipus de hash  
SELECT STANDARD_HASH('contrasenya', 'SHA256') FROM dual;        </code></pre>
     <p>STANDARD_HASH soporta tots els algorismes moderns (MD5, SHA1, SHA256, SHA384, SHA512, SHA3_256, SHA3_512‚Ä¶)</p>
     <p>Tamb√© es pot fer amb la funcio HASH del paquet DBMS_CRYPTO</p>
<pre><code>SELECT RAWTOHEX(  DBMS_CRYPTO.HASH(HEXTORAW('1231'),3) ) FROM dual;
SELECT RAWTOHEX(  DBMS_CRYPTO.HASH(UTL_I18N.STRING_TO_RAW('SECRETA'),4) ) FROM dual;  
-- On el num del segon parametre =>  type 3:SHA-1  type 4:SHA256  type 5:SHA384  type 6:SHA512  </code></pre>
<h4>Exemple de xifrat amb AES</h4>
<pre><code>SELECT RAWTOHEX(
         DBMS_CRYPTO.ENCRYPT(
           src => UTL_RAW.cast_to_raw('Text secret'),
           typ => 4354, -- AES_CBC_PKCS5
           key => UTL_RAW.cast_to_raw('0123456789ABCDEF0123456789ABCDEF'),
           iv  => UTL_RAW.cast_to_raw('ABCDEF9876543210')
         )
       ) AS text_encriptat_hex
FROM dual;
</code></pre>
<pre><code>Oracle determina autom√†ticament quina versi√≥ d‚ÄôAES s‚Äôha d‚Äôaplicar segons la longitud del RAW 
  que s'envie al par√†metre key (Clau 16 bytes ‚Üí AES-128 , Clau 24 bytes ‚Üí AES-192 , Clau 32 bytes ‚Üí AES-256)</code></pre>

    <h4> Convertir entre formats:</h4>
    <ul>
        <li><code>UTL_I18N.STRING_TO_RAW</code> ‚Üí text a RAW</li>
        <li><code>RAWTOHEX</code> ‚Üí RAW a hexadecimal</li>
        <li><code>UTL_I18N.RAW_TO_CHAR</code> ‚Üí RAW a text</li>
    </ul>

    <h3>üíæ TDE ‚Äì Transparent Data Encryption</h3>
    <p>Xifrat autom√†tic a nivell de disc. No cal modificar el codi de les aplicacions.</p>

    <h4> Components:</h4>
    <ul>
        <li><strong>TDE Master Key</strong> ‚Üí clau mestra</li>
        <li><strong>Keystore (Wallet)</strong> ‚Üí arxiu amb claus</li>
        <li><strong>Column / Tablespace Keys</strong> ‚Üí claus espec√≠fiques</li>
    </ul>

    <h4>üîÅ Modalitats:</h4>
    <ul>
        <li><strong>Column-level TDE</strong>: nom√©s algunes columnes</li>
        <li><strong>Tablespace-level TDE</strong>: totes les dades dins l‚Äôespai de taules</li>
    </ul>


    <hr><hr><h3> Bones pr√†ctiques</h3>
    <ul>
        <li>Xifra nom√©s les dades sensibles</li>
        <li>Evita BASE64 o ROT13 per contrasenyes</li>
        <li>Usa funcions <code>HASH()</code> per emmagatzemar contrasenyes</li>
        <li>Gestiona la keystore amb seguretat</li>
        <li>Audita l‚Äôacc√©s a dades xifrades</li>
    </ul>

    <h3> Conclusi√≥</h3>
    <p>L‚Äôencriptaci√≥ √©s essencial per a la protecci√≥ de dades en entorns reals i √©s un requisit legal i de bones pr√†ctiques. Oracle ofereix solucions potents com TDE i DBMS_CRYPTO que cobreixen necessitats t√®cniques i legals.</p>

    <blockquote>
        üîê Una bona gesti√≥ de claus, un √∫s moderat del xifrat i l‚Äôauditoria d‚Äôacc√©s s√≥n claus per garantir seguretat real.
    </blockquote>

    </section>
         

  <section id="auditoria">
    <h2>üïµÔ∏è Auditoria en Oracle</h2>
  
    <h3>üìò Qu√® √©s una auditoria?</h3>
    <p>
      L‚Äôauditoria √©s una funcionalitat dels sistemes gestors de bases de dades que permet <strong>registrar i controlar l‚Äôactivitat dels usuaris</strong>.
      √âs especialment √∫til per motius de seguretat, detecci√≥ d‚Äôerrors, tra√ßabilitat i compliment normatiu (ex. RGPD).
    </p>
  
    <h3>üéØ Objectius de l‚Äôauditoria</h3>
    <ul>
      <li> Detectar accions no autoritzades</li>
      <li> Rastrejar canvis o acc√©s a dades sensibles</li>
      <li> Monitorar l‚Äôactivitat d‚Äôusuaris privilegiats</li>
      <li> Complir amb auditories internes o externes</li>
    </ul>
  
    <h3>‚öôÔ∏è Tipus d‚Äôauditoria en Oracle</h3>
    <ul>
      <li><strong>Est√†ndard (traditional)</strong>: basada en ordres com <code>AUDIT</code></li>
      <li><strong>Auditoria unificada (Unified Audit)</strong>: disponible des d‚ÄôOracle 12c</li>
    </ul>
  
    <h4>üîé Difer√®ncies:</h4>
    <table border="1">
      <thead><tr><th>Caracter√≠stica</th><th>Est√†ndard</th><th>Unificada</th></tr></thead>
      <tbody>
        <tr><td>Implementaci√≥</td><td>Bases separades (AUD$)</td><td>Totes les auditories integrades</td></tr>
        <tr><td>Activa per defecte</td><td>No</td><td>S√≠, des de 12c</td></tr>
        <tr><td>Control granular</td><td>Limitat</td><td>Molt flexible</td></tr>
        <tr><td>Millor rendiment</td><td>No</td><td>S√≠</td></tr>
      </tbody>
    </table>
  
    <h3>üõ†Ô∏è Activar auditoria est√†ndard (tradicional)</h3>
    <p>Des d'Oracle23ai no es pot fer servir.</p>
  <!--  
    <pre>
-- Activar l‚Äôauditoria global
SHOW PARAMETER audit_trail;
-- Si el valor √©s NONE, est√† desactivada.        </pre>
      <p>
        S‚Äôha de configurar el par√†metre:
        <code>audit_trail = DB</code> al fitxer d‚Äôinici <code>init.ora</code> o via <code>ALTER SYSTEM</code>        </p>
      <p class="alert">En Oracle multitenant, l‚Äôauditoria est√†ndard es configura nom√©s al CDB$ROOT.</p>  
     <pre>ALTER SYSTEM SET audit_trail='DB' SCOPE=SPFILE;
--  Despr√©s reinicia la base de dades:      
SHUTDOWN IMMEDIATE;   --  Des de sqlplus  !!
STARTUP;              --  Des de sqlplus  !!
     </pre> 
    
      <h3> Exemples d'ordres <code>AUDIT</code></h3>
      <pre>-- Audita logins d'usuaris
AUDIT SESSION;

-- Audita l‚Äôacc√©s a taula
AUDIT SELECT ON usu1.alumnes;

-- Audita connexions fallides
AUDIT SESSION WHENEVER NOT SUCCESSFUL;

-- Audita qualsevol modificaci√≥ de taula
AUDIT INSERT, UPDATE, DELETE ON alumnes;
      </pre>
    
      <h3> Consultar resultats d‚Äôauditoria (vistes del DD)</h3>
      <ul>
        <li><code>DBA_AUDIT_TRAIL</code>: acc√©s general</li>
        <li><code>USER_AUDIT_TRAIL</code>: acc√©s nom√©s al propi esquema</li>
        <li><code>DBA_COMMON_AUDIT_TRAIL</code>: auditories unificades</li>
      </ul>
    
      <pre>
SELECT username, action_name, obj_name, timestamp
FROM dba_audit_trail
WHERE obj_name = 'ALUMNES'
ORDER BY timestamp DESC;
      </pre>
    
      <h3>üßπ Esborrar o buidar resultats (amb compte!)</h3>
      <pre>
DELETE FROM sys.aud$ WHERE obj$name = 'ALUMNES';
-- o
TRUNCATE TABLE sys.aud$;
      </pre>

      <ul>
        <li>Oracle impulsa Unified Auditing, per√≤ Standard Auditing encara √©s compatible.</li>
        <li>Si Unified Auditing est√† en mode mixed mode, pots utilitzar Standard i Unified alhora.</li>
      </ul>
   --> 
      <h3>üõ†Ô∏è Unified Audit (Oracle 12c+)</h3>
      <p>
        Unifica tots els registres d‚Äôauditoria: privilegis, ordres, errors, logons...  
        S‚Äôactiva amb <code>ENABLE_UNIFIED_AUDIT = TRUE</code> al par√†metre de sistema.
      </p>
<pre>SELECT VALUE
FROM V$OPTION
WHERE PARAMETER = 'Unified Auditing';   -- per saber si esta activa</pre>      
  <p>Modes de unified</p>
    <p>Mixed Mode: pots usar AUDIT SESSION i Unified Auditing alhora <br>
      Only Mode: nom√©s Unified Auditing funciona; els antics comandos AUDIT estan bloquejats</p>
    
      <h4>Exemple de pol√≠tica unificada:</h4>
      <pre>
CREATE AUDIT POLICY aud_logins
  ACTIONS LOGON;

AUDIT POLICY aud_logins;    --   Audita logins d'usuaris

CREATE AUDIT POLICY acces_alumnes
  ACTIONS SELECT ON alumnes;

AUDIT POLICY acces_alumnes;      --   Audita selects a una taula (de qualsevol usuari)

AUDIT POLICY acces_alumnes BY usuari1,usuari2;  --   Audita selects a una taula (per part de usuari1 o usuari2)
      </pre>
      <h3>üì¶ Vistes d‚Äôauditoria unificada</h3>
      <ul>
        <li><code>AUDIT_UNIFIED_POLICIES</code></li>
        <li><code>AUDIT_UNIFIED_ENABLED_POLICIES</code></li>
        <li><code>UNIFIED_AUDIT_TRAIL</code></li>
      </ul>

      <h3>Com vore les regles creades </h3>
      <pre>SELECT policy_name, audit_option, condition_eval_opt, audit_condition
FROM audit_unified_policies 
ORDER BY policy_name;</pre>
<h3>Com vore les regles  actives</h3>
<pre>SELECT * FROM AUDIT_UNIFIED_ENABLED_POLICIES;</pre>     
    

     <h3>Com vore els registres de l'auditoria</h3>
      <pre>SELECT EVENT_TIMESTAMP, DBUSERNAME, USERHOST, ACTION_NAME
      FROM UNIFIED_AUDIT_TRAIL
      WHERE OBJECT_NAME = 'ALUMNES';
      ORDER BY EVENT_TIMESTAMP DESC;   </pre>

  <pre>-- Deshabilitar primer
NOAUDIT POLICY acces_alumnes;

-- Eliminar la pol√≠tica
DROP AUDIT POLICY nom_politica;</pre>    
    
      <h3> Consells de seguretat i gesti√≥</h3>
      <ul>
        <li> Activa l‚Äôauditoria per accions sensibles (login, esborrar, canviar permisos)</li>
        <li> Revisa regularment els registres d‚Äôauditoria</li>
        <li> No deixis l‚Äôauditoria oberta en producci√≥ sense revisar l‚Äôespai</li>
        <li> Automatitza l‚Äôan√†lisi amb scripts o informes</li>
      </ul>
    
      <h3> Conclusi√≥</h3>
      <p>
        L‚Äôauditoria √©s una eina potent per a la seguretat i el control de bases de dades Oracle.  
        Permet identificar comportaments sospitosos, controlar acc√©s no autoritzat i mantenir la tra√ßabilitat de les operacions.
        A m√©s, √©s una pr√†ctica recomanada per normatives legals i de qualitat.
      </p>
    </section>
      
 <!--     <section id="exercici-auditoria">
        <h2>üß™ Exercici interactiu de simulaci√≥ d‚Äôauditoria Oracle</h2>
        <p>Introdueix ordres d‚Äôauditoria o consultes per veure qu√® s‚Äôhauria registrat.</p>
      
        <textarea id="inputSQL" rows="5" style="width: 100%;" placeholder="Escriu una ordre, ex:
      AUDIT SELECT ON alumnes;
      SELECT * FROM dba_audit_trail WHERE obj_name = 'ALUMNES';"></textarea>
      
        <button onclick="executarSimulacio()">Executar</button>
      
        <div id="resultatSimulacio" style="margin-top: 20px; background: #f4f4f4; padding: 1rem; border-radius: 6px;"></div>
      
        <script>
          const auditories = [];
      
          function executarSimulacio() {
            const entrada = document.getElementById('inputSQL').value.trim().toUpperCase();
            const output = document.getElementById('resultatSimulacio');
            let resposta = "";
      
            if (entrada.startsWith("AUDIT ")) {
              const accio = entrada.replace("AUDIT", "").trim();
              auditories.push({
                accio: accio,
                usuari: "USUARI1",
                objecte: accio.includes("ON") ? accio.split("ON")[1].trim() : "GLOBAL",
                timestamp: new Date().toLocaleString()
              });
              resposta = `<b>‚úÖ Auditoria activada correctament:</b> <code>${accio}</code>`;
            } else if (entrada.startsWith("SELECT") && entrada.includes("DBA_AUDIT_TRAIL")) {
              if (auditories.length === 0) {
                resposta = "üì≠ No s'ha registrat cap acci√≥ encara.";
              } else {
                resposta = "<table border='1' cellpadding='6'><thead><tr><th>Usuari</th><th>Acci√≥</th><th>Objecte</th><th>Hora</th></tr></thead><tbody>";
                auditories.forEach(a =>
                  resposta += `<tr><td>${a.usuari}</td><td>${a.accio}</td><td>${a.objecte}</td><td>${a.timestamp}</td></tr>`
                );
                resposta += "</tbody></table>";
              }
            } else {
              resposta = "‚ö†Ô∏è Ordre no reconeguda. Pots usar <code>AUDIT ...</code> o <code>SELECT * FROM DBA_AUDIT_TRAIL</code>.";
            }
      
            output.innerHTML = resposta;
          }
        </script>
      </section>  -->
      

      <section id="integritat">
        <h2>üß¨ Integritat en bases de dades Oracle</h2>
      
        <h3>üìò Qu√® √©s la integritat?</h3>
        <p>
          La <strong>integritat</strong> d‚Äôuna base de dades fa refer√®ncia al conjunt de normes i restriccions que garanteixen que les dades emmagatzemades siguen <strong>coherents, correctes i fiables</strong>.
          Aquesta integritat √©s fonamental per garantir la <strong>qualitat de la informaci√≥</strong> i el correcte funcionament de les aplicacions que la utilitzen.
        </p>
      
        <h3> Tipus d‚Äôintegritat</h3>
        <ul>
          <li><strong>Integritat d‚Äôentitat</strong> ‚Üí cada fila ha de ser identificable de forma √∫nica (clau prim√†ria)</li>
          <li><strong>Integritat referencial</strong> ‚Üí assegura la coher√®ncia entre taules relacionades (claus foranes)</li>
          <li><strong>Integritat de domini</strong> ‚Üí les dades han de complir certs valors o formats (tipus de dades, CHECK...)</li>
          <li><strong>Integritat d‚Äôusuari</strong> ‚Üí validacions aplicacionals o de negoci imposades per l'usuari o aplicaci√≥</li>
        </ul>
      
        <h3> Integritat d'entitat</h3>
        <p>
          Es garanteix mitjan√ßant l‚Äô√∫s de <code>PRIMARY KEY</code>, que assegura que cada fila sigui √∫nica i no nul¬∑la.
        </p>
        <pre>CREATE TABLE alumnes (
  id NUMBER PRIMARY KEY,
  nom VARCHAR2(50)
);          </pre>
      
        <h3> Integritat referencial</h3>
        <p>
          Mant√© la coher√®ncia entre dues taules relacionades mitjan√ßant una <code>FOREIGN KEY</code>.  
          Evita que una fila faci refer√®ncia a un valor inexistent.
        </p>
        <pre>CREATE TABLE cursos (
  id NUMBER PRIMARY KEY,
  nom VARCHAR2(50)
);

CREATE TABLE alumnes (
  id NUMBER PRIMARY KEY,
  nom VARCHAR2(50),
  id_curs NUMBER,
  FOREIGN KEY (id_curs) REFERENCES cursos(id)
);          </pre>
      
        <p>Amb aix√≤, no es pot assignar un <code>id_curs</code> a un alumne que no existeixi a la taula <code>cursos</code>.</p>
      
        <h3> Integritat de domini</h3>
        <p>
          Limita els valors permesos en una columna. Es pot implementar amb tipus de dades, restriccions <code>NOT NULL</code>, <code>CHECK</code> o <code>DEFAULT</code>.
        </p>
      
        <pre>CREATE TABLE alumnes (
  id NUMBER PRIMARY KEY,
  nom VARCHAR2(50) NOT NULL,
  edat NUMBER CHECK (edat >= 16),
  pais VARCHAR2(30) DEFAULT 'Espanya'
);           </pre>
      
        <p>
          Aix√≤ garanteix que <code>nom</code> sempre tindr√† valor, <code>edat</code> sigui ‚â• 16 i <code>pais</code> tindr√† un valor per defecte.
        </p>
      
        <h3> Integritat d‚Äôusuari</h3>
        <p>
          No s‚Äôimplementa a nivell de base de dades, sin√≥ via aplicacions o triggers. Controla normes espec√≠fiques com:
        </p>
        <ul>
          <li>Un usuari no pot tenir dues reserves actives</li>
          <li>Els horaris d‚Äôuna aula no poden solapar-se</li>
        </ul>
      
        <p>
          Aquest tipus d‚Äôintegritat sovint es basa en <code>PL/SQL</code> o l√≤gica de negoci a l‚Äôaplicaci√≥.
        </p>
      
        <h3> Conclusi√≥</h3>
        <p>
          Mantenir la integritat de les dades √©s essencial per garantir que el sistema sigui <strong>fiable, coherent i funcional</strong>.  
          Oracle ofereix m√∫ltiples mecanismes per implementar integritat a nivell f√≠sic, l√≤gic i d‚Äôaplicaci√≥.
        </p>
      
        <blockquote>
          üîê ‚ÄúLa seguretat comen√ßa amb la confian√ßa en les dades. I la confian√ßa es construeix amb integritat.‚Äù
        </blockquote>
      </section>
      

      <section id="transaccions">
        <h2> Transaccions en Oracle</h2>
      
        <h3>üìò Qu√® √©s una transacci√≥?</h3>
        <p>
          Una <strong>transacci√≥</strong> √©s una seq√º√®ncia d‚Äôoperacions SQL (normalment de manipulaci√≥ de dades: <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>) que es tracten com una <strong>unitat indivisible de treball</strong>.
          L‚Äôobjectiu d‚Äôuna transacci√≥ √©s assegurar que les dades es mantinguin <strong>coherents</strong> i <strong>amb integritat</strong>.
        </p>
        <p>Una transacci√≥, o es fa tota o no es fa res, per√≤ no pot en cap cas quedar a mitges, una part feta i una altra no.</p>
        <p>Totes les operacions que en formen part han de completar-se correctament. Si alguna falla, cap de les altres no ha de tenir efecte.</p>
        <!--<p>Les transaccions tracte d'evitar: Actualitzacions parcials, concurrency problems, P√®rdua de dades a causa d‚Äôerrors </p> -->
        <p>Els interbloquejos ( <strong>deadlocks</strong>  ) s√≥n un problema que les transaccions i els mecanismes de control de concurr√®ncia intenten evitar o gestionar</p>
        <p>Un interbloqueig passa quan dues o m√©s transaccions es bloquegen m√∫tuament, cadascuna esperant un recurs 
          (normalment un registre o una taula) que l‚Äôaltra t√© bloquejat.Comm que cap pot continuar, totes queden aturades indefinidament (i a m√©s a m√©s afecten a la resta de sessions)</p>
        <pre><code>Exemple senzill:
    Transacci√≥ A t√© bloquejada la fila 1 i vol la fila 2.
    Transacci√≥ B t√© bloquejada la fila 2 i vol la fila 1.
Cap pot continuar ‚Üí deadlock</code></pre>

        <h3> Propietats d‚Äôuna transacci√≥ (ACID)</h3>
        <ul>
          <li><strong>Atomicitat:</strong> totes les operacions s‚Äôexecuten o cap (tot o res)</li>
          <li><strong>Consist√®ncia:</strong> deixa la BD en un estat v√†lid despr√©s de completar-se</li>
          <li><strong>A√Øllament:</strong> cada transacci√≥ s‚Äôexecuta com si fos l‚Äô√∫nica</li>
          <li><strong>Durabilitat:</strong> un cop feta la transacci√≥, els canvis s√≥n permanents</li>
        </ul>
      
        <h3> Ordres b√†siques de control de transaccions</h3>
        <p>ORACLE √©s un sistema de base de dades purament transaccional, de tal forma, que 
          la instrucci√≥ BEGIN TRANSACTION no existeix</p>
        <p>En una transacci√≥ les dades modificades <strong>no s√≥n visibles</strong> per la resta d'usuaris fins que es confirme la transacci√≥</p>
      
        <h4> <code>COMMIT</code></h4>
        <p>
          Fa permanents tots els canvis realitzats en la transacci√≥. No es poden desfer despr√©s. En este moment les dades modificades ja son
          visibles per la resta d'usuaris .       </p>
        <pre>INSERT INTO alumnes VALUES (10, 'Joan', 20);
COMMIT;          </pre>
       <p>Les sent√®ncies de finalitzaci√≥ de transacci√≥ s√≥n COMMIT i ROLLBACK</p>
        <h4> <code>ROLLBACK</code></h4>
        <p>
          Desf√† tots els canvis realitzats des del darrer <code>COMMIT</code>. Torna l‚Äôestat de la BD a com estava abans.
        </p>
        <pre>UPDATE alumnes SET edat = 30 WHERE id = 10;
ROLLBACK; -- Anul¬∑la l'actualitzaci√≥            </pre> 
      
        <h4> <code>SAVEPOINT</code></h4>
        <p>
          Permet definir punts intermedis dins d‚Äôuna transacci√≥ per fer <code>ROLLBACK</code> parcial.
        </p>
        <pre>SAVEPOINT punt1;
DELETE FROM alumnes WHERE edat &lt; 18;

SAVEPOINT punt2;
UPDATE alumnes SET nom = 'An√≤nim' WHERE edat &gt; 25;

ROLLBACK TO punt1; -- desf√† nom√©s fins al punt1           </pre>
      
        <h3> Transaccions autom√†tiques i manuals</h3>
        <ul>
          <li>DDL: Oracle Server <strong>executa</strong> un COMMIT impl√≠cit abans i despr√©s de cada instrucci√≥ DDL,</li>
          <li>DCL: Oracle Server <strong>executa</strong> un COMMIT impl√≠cit abans i despr√©s de cada sent√®ncia DCL</li>
          <li>DML: Aquestes sent√®ncies no executen un COMMIT impl√≠cit</li>
          <li>Cridades a procediments o funcions: Aquestes sent√®ncies no executen un COMMIT impl√≠cit</li>
          <li>ALTER SESSION i ALTER SYSTEM: Aquestes sent√®ncies no executen un COMMIT impl√≠cit</li>
          <li>Els blocs <code>BEGIN</code> ... <code>END</code> no executen un COMMIT impl√≠cit.</li>
        </ul>
      
        <h3> Consells pr√†ctics</h3>
        <ul>
          <li> Fes <code>COMMIT</code> nom√©s quan estiguis segur que la transacci√≥ ha anat b√©</li>
          <li> Utilitza <code>SAVEPOINT</code> per controlar operacions complexes</li>
          <li> Usa <code>ROLLBACK</code> sempre que detectis un error o canvi involuntari</li>
          <li> En entorns multiusuari, la gesti√≥ correcta de transaccions evita bloquejos i inconsist√®ncies</li>
        </ul>
      
        <h3> Relaci√≥ amb la seguretat</h3>
        <p>
          Una gesti√≥ acurada de les transaccions garanteix:
        </p>
        <ul>
          <li> Tra√ßabilitat i reversibilitat en cas d‚Äôerror</li>
          <li> Integritat davant fallades del sistema</li>
          <li> Registre coherent en conjunci√≥ amb l‚Äôauditoria</li>
        </ul>
      <hr>
      <p>Oracle t√© mecanismes per detectar <strong>deadlocks</strong> de manera autom√†tica. Quan detecta que dos
         transaccions no poden continuar, avorta una de les dues i retorna un error:</p>
      <p>La transacci√≥ que Oracle sol avortar √©s la que porta menys treball fet (la que ha modificat menys dades), tamb√© coneguda 
        com la ‚Äúvictim transaction‚Äù, per minimitzar la p√®rdua de treball.</p>
        <pre><code>ORA-00060: deadlock detected while waiting for resource</code></pre>
        <p>Aix√≠, almenys una pot continuar i el sistema no queda bloquejat.</p>
        <p>Quan Oracle mata una transacci√≥ per deadlock, la seva part desada es desf√† (rollback), mantenint la coher√®ncia.</p>

        <h3> Conclusi√≥</h3>
        <p>
          El control de transaccions √©s una eina fonamental per garantir que el sistema de base de dades sigui <strong>segur, coherent i robust</strong>.
          Oracle proporciona instruccions clares per controlar de forma manual i segura l‚Äôexecuci√≥ de canvis en les dades.
        </p>

       <hr> <h3> Exemple (vore transacci√≥ per completar)</h3>
        <p>Obrim 2 sessions ( en SQL*PLUS ) amb usuari1 ( dos cmd diferents)   </p>
        <pre> 
    En la primera sessi√≥ (1er CMD)
    SQL> insert into prueba10 (id, nom) values (1000,‚Äôvalor1 ‚Äô);
    1 row created.
        </pre>
    <pre>
    En la segon sessi√≥  (2on cmd)    
    SQL> select count(*) from prueba10;
    COUNT(*)
    ----------
    0</pre>
        <pre>
    En la primera sessi√≥ (1er CMD)
    SQL> commit;            
        </pre>
    <pre>
    En la segon sessi√≥ (2on CMD)    
    SQL> select count(*) from prueba10;
    COUNT(*)
    ----------
    1
    </pre>

    <hr><h4>Exemple ( de deadlock )</h4>
    <p>Suposem que tenim una taula:</p>
    <pre><code>CREATE TABLE comptes (
    id NUMBER PRIMARY KEY,
    saldo NUMBER
    ); </code></pre>
    <p>i dos files</p>
    <pre><code>INSERT INTO comptes VALUES (1, 100);
INSERT INTO comptes VALUES (2, 200);
COMMIT; </code></pre>
<p>Obri dos sessios sql diferents, Sessio A i Sessio B</p>
<pre>Sessio A
  -- Bloqueja la fila amb id = 1
UPDATE comptes SET saldo = saldo + 10 WHERE id = 1;
Sessio B
-- Bloqueja la fila amb id = 2
UPDATE comptes SET saldo = saldo + 20 WHERE id = 2;

-- SESSION A intenta agafar la fila que t√© B
UPDATE comptes SET saldo = saldo - 5 WHERE id = 2;
--  ‚Üí A queda esperant, perqu√® B t√© bloquejada la fila 2.

SESSION B intenta agafar la fila que t√© A
UPDATE comptes SET saldo = saldo - 5 WHERE id = 1;
-- ‚Üí B queda esperant, perqu√® A t√© bloquejada la fila 1.

-- I ac√≠ √©s on Oracle detecta el deadlock
-- Oracle trenca el bloqueig i dona error a una de les dues sessions (normalment la segona que entra al conflicte)
</pre>

   </section>
      

      <section id="backups">
        <h2>üíæ Recuperaci√≥ i c√≤pies de seguretat en Oracle</h2>
      
        <h3> Per qu√® cal fer c√≤pies de seguretat?</h3>
        <p>
          Les c√≤pies de seguretat s√≥n essencials per garantir la <strong>continu√Øtat del servei</strong> i la <strong>protecci√≥ de la informaci√≥</strong>.  
          En cas de fallada del sistema, error hum√†, corrupci√≥ de dades o atacs, una bona estrat√®gia de backup permet recuperar la base de dades sense p√®rdues.
        </p>
        <p>La q√ºesti√≥ de fer c√≤pies de seguretat des de dins d‚ÄôOracle (usant eines com RMAN o exportacions l√≤giques com Data Pump) 
          versus fer-les des de fora (copiant fitxers del sistema operatiu) √©s molt important perqu√® afecta 
          la consist√®ncia i la recuperabilitat de la base de dades</p>
        <p>Fer c√≤pies de seguretat des de dins d‚ÄôOracle √©s cr√≠tic perqu√® assegura que la base de dades es pugui recuperar correctament i 
          sense p√®rdua de dades, fins i tot si est√† en funcionament. Fer-ho des del sistema operatiu nom√©s √©s segur si la base est√† apagada,
           cosa poc pr√†ctica en entorns de producci√≥</p>
        <p>Problemes si es fan des de fora del SGBD: Inconsist√®ncia, Recuperaci√≥ complicada, No registra transaccions </p>
        <p>Avantatges si es fan des de dins del SGBD: Consist√®ncia de dades, Recuperaci√≥ puntual, Gesti√≥ de logs autom√†tica, C√≤pies en calent, Automatitzaci√≥ i verificaci√≥:</p>

      
        <h3>üéØ Objectius d‚Äôuna c√≤pia de seguretat</h3>
        <ul>
          <li>Restaurar les dades despr√©s d‚Äôun error</li>
          <li>Permetre la recuperaci√≥ puntual o total</li>
          <li>Facilitar entorns de prova o migracions</li>
          <li>Complir normatives legals (protecci√≥ de dades)</li>
        </ul>
      
        <h3> Tipus de c√≤pies de seguretat</h3>
        <ul>
          <li><strong>F√≠siques</strong>: c√≤pies dels fitxers f√≠sics (datafiles, control files, logs...)</li>
          <li><strong>L√≤giques</strong>: exportaci√≥ d‚Äôesquemes, taules, usuaris o dades via utilitats com <code>expdp</code> i <code>impdp</code></li>
        </ul>
        <hr><ul>
          <li><strong>Totals</strong>: Una PDB sencera, o una CDB sencera</li>
          <li><strong>Parcials</strong>: Part d'una BBDD, un Tablespace, Una taula concreta, Un esquema</li>
        </ul>
        <hr><ul>
          <li><strong>Online</strong>: Tamb√© s‚Äôanomena c√≤pia de seguretat en calent. Es fa mentre la base de dades continua activa i els usuaris treballen.</li>
          <li><strong>Offline</strong>: Tamb√© s‚Äôanomena c√≤pia de seguretat freda. Es realitza quan la base de dades est√† completament aturada</li>
        </ul>
      
        <hr><h3> Estrat√®gies de backup</h3>
        <ul>
          <li><strong>Completa:</strong> c√≤pia total de la BD</li>
          <li><strong>Incremental:</strong> nom√©s les dades modificades des del darrer backup</li>
          <li><strong>Diferencial:</strong> totes les modificacions des del darrer backup complet</li>
          <li><strong>Continuada:</strong> amb redologs i archivelogs actius</li>
        </ul>
      <h3> Mecanismes d'Oralce</h3>
        <ul>
          <li><strong>Exportaci√≥:</strong> la c√≤pia l√≤gica es guarda en l‚Äôequip client</li>
          <li><strong>DataPump:</strong> la c√≤pia l√≤gica es guarda en l‚Äôequip servidor</li>
          <li><strong>RMAN:</strong> la c√≤pia f√≠sica o incremental es guarda en l‚Äôequip servidor</li>
        </ul>

        <hr><h3> Eines principals de backup en Oracle</h3>
       <h3>1. üì§ Exportaci√≥ i importaci√≥ legacy (Original Export))</h3>
        <pre>exp / imp</pre>
        <ul>
          <li>S'executa des de la l√≠nia de comandos/terminal</li>
          <li>La c√≤pia l√≤gica es guarda en l‚Äôequip des d'on s'executa  (sol ser client)</li>
          <li>Modes: full, user (esquema), tablespace, table, query</li>
          <li>Es pot usar un fitxer de par√†metres parfile=</li>
        </ul>
        <pre>EXEMPLE
exp username/password@ipAddress:portNumber/serviceName file=/recovery_area/export/prueba_export.dmp full=yes buffer=1000000          
        </pre>
        <p>Si volem fer un exp total (full=yes), l'usuari que l'execute necessita el rol EXP_FULL_DATABASE</p>
        <pre>Per cridar amb sys
exp \'username/password@instance AS SYSDBA\' parametres</pre>        
         
        <br> <img src="imgs/copseg_exporta.png" alt="exportacio de dades" style="width: 60%" class="imatge-esquerra">
      <p>Un mecanisme molt semblant i m√©s c√≤mode i intuitiu es pot trobar a SQL Developer, amb l'eina de Exportar. 
          Des del menu Eines-Exportaci√≥ de base de dades, llan√ßa unes finestres per indicar que, com , on fer una exportaci√≥.</p>
        <p>Les dades es guardarn en la m√†quina client ( o un lloc on esta puga accedir )</p>
         <pre><code>SQL Developer permet exportar / importar dades, esquemes i resultats de consultes a diversos formats </code></pre>

         <hr><h3>2. üì§ Data Pump</h3>
        <pre>expdp / impdp</pre>
        <ul>
          <li>S'executa des de la linea de comandos/terminal (per√≤ la c√≤pia s'executa en el servidor)</li>
          <li>Tamb√© es pot executar des de dins de l'SGBD amb el paquet DBMS_DATAPUMP (pr√≤xim tema )</li>
          <li>La c√≤pia l√≤gica es guarda en l'equip servidor (o un lloc assolible des del servidor)</li>
          <li>M√©s r√†pid, m√©s rendiment, diversos fils en paral¬∑lel</li>
          <li>Modes: full=Y, eschemas=esquema_1[, esquema_N], tablespaces=, tables=, QUERY=</li>
          <li>Es pot usar un fitxer de par√†metres parfile=</li>
        </ul>
       <pre>
-- EXEMPLE    
-- Guardar tot un esquema (tots els objectes d'un usuari)
expdp username/password@ipAddress:portNumber/serviceName directory=dumpdir dumpfile=export.dmp logfile=fichero.log
expdp usuari/password SCHEMAS=usuari DUMPFILE=export.dmp LOGFILE=export.log   --No cal posar path f√≠sic !!

-- Recuperar en una altra BD
impdp usuari/password DUMPFILE=export.dmp LOGFILE=import.log           </pre>

        <ul> Que es pot guardar / recuperar  (mode)
          <li>Tot: FULL=Y</li>
          <li>Una o m√©s Tablespaces:  TABLESPACES=tb1[,...]</li>
          <li>Un o m√©s esquemes: SCHEMAS= usuari1 [,...] </li>
          <li>Una o m√©s taules: TABLE= taula1 [,...]</li>
          <li>Una part d'una taula:  QUERY [usuari.taula:] WHERE ....</li>
          <li>No es poden combinar en una mateixa exportaci√≥, pero es poden fer executat diverses exportacions</li>
        </ul>
        <img src="imgs/copseg_full.png" alt="dp full" style="width: 30%" >
        <img src="imgs/copseg_tblspc.png" alt="dp tablespace" style="width: 30%" >
        <img src="imgs/copseg_sch.png" alt="dp schema" style="width: 30%" >
        <br>
        <img src="imgs/copseg_table.png" alt="dp table" style="width: 40%" >
        <img src="imgs/copseg_query.png" alt="dp query" style="width: 30%" >

        <p>Es necessari que el servidor tinga acc√©s al lloc on far√† (el servidor) les c√≤pies</p>
        <p>Primer: Definir un directori </p>
        <pre>CREATE [OR REPLACE] DIRECTORY directory_name AS 'path_name';</pre>
        <p>El path deu existir i tindre permisos d'escriptura</p>
        <p>Els fitxers de dest√≠ NO deuen existir (o donar√† error la c√≤pia)</p>
        <p>L'usuari que connecta ha de tindre permisos d'acc√©s a les dades per fer c√≤pies</p>
        <p>Per fer una c√≤pia completa es necessita un perm√≠s (ROL) concret</p>
        <pre>DATAPUMP_EXP_FULL_DATABASE
DATAPUMP_IMP_FULL_DATABASE    </pre>

          <pre>EXEMPLE d'arxiu 'parfile'
TABLESPACES=users
DUMPFILE=exp2.dmp
DIRECTORY=dirdump
LOGFILE=exp2.log            </pre>

       <hr> <h3>3. üîÑ RMAN (Recovery Manager)</h3>
        <p>
          Eina oficial d'Oracle per fer backups i recuperar dades. Pot treballar amb c√≤pies incrementals, verificar integritat i automatitzar tasques.
        </p>
        <pre>
      -- Exemple: backup complet
      RMAN> BACKUP DATABASE;
      
      -- Backup nom√©s de la part SYSTEM
      RMAN> BACKUP TABLESPACE system;
      
      -- Recuperaci√≥
      RMAN> RESTORE DATABASE;
      RMAN> RECOVER DATABASE;
        </pre>
      

        <h4>üìã Exemple de procediment b√†sic amb RMAN</h4>
        <pre>
      -- Connexi√≥
      rman target /
      
      -- Comprovaci√≥ de c√≤pia
      VALIDATE DATABASE;
      
      -- C√≤pia
      BACKUP AS BACKUPSET DATABASE PLUS ARCHIVELOG;
      
      -- Restauraci√≥
      RESTORE DATABASE;
      RECOVER DATABASE;
        </pre>
        <hr>

      <hr><img src="imgs/copseg_SQL_loader.png" alt="sql loader" style="width: 20%" class="imatge-dreta" >
      <p>SQL*Loader √©s una utilitat que permet la inserci√≥ de dades des d'un arxiu pla a una o m√©s bases de dades. </p>
      <p> Durant una sola de les seves execucions √©s possible omplir m√∫ltiples taules amb dades de m√∫ltiples arxius, 
        manejar registres d'ample variable o fix, manipular les dades entrants per a tractar amb valors nuls, delimitadors 
        i espais en blanc, obviar registres o encap√ßalats i reaccionar enfront de fallades del proc√©s de carregat</p>


       <hr> <h3> Arxius implicats en la recuperaci√≥</h3>
        <ul>
          <li><strong>Datafiles:</strong> contenen les dades</li>
          <li><strong>Control file:</strong> descriu l'estructura de la BD</li>
          <li><strong>Redo logs:</strong> registren tots els canvis</li>
          <li><strong>Archivelogs:</strong> c√≤pia dels redo logs, essencial per a recuperaci√≥ completa</li>
        </ul>
      
        <h3> Escenaris de recuperaci√≥</h3>
        <ul>
          <li> Recuperaci√≥ completa: amb tots els archivelogs i datafiles</li>
          <li> Recuperaci√≥ parcial: taules, fitxers o inst√†ncia</li>
          <li> Restauraci√≥ en cas de p√®rdua del control file</li>
        </ul>
      
        <h3> Bones pr√†ctiques de seguretat</h3>
        <ul>
          <li> Programar backups regulars</li>
          <li> Mantenir c√≤pies en ubicacions externes</li>
          <li> Fer proves peri√≤diques de recuperaci√≥</li>
          <li> Utilitzar <code>RMAN VALIDATE</code> per comprovar integritat</li>
          <li> Documentar el procediment de recuperaci√≥</li>
        </ul>        
      
        <h3> Conclusi√≥</h3>
        <p>
          Disposar d‚Äôun pla de c√≤pies de seguretat fiable i efectiu √©s <strong>fonamental per garantir la seguretat i continu√Øtat</strong> de qualsevol sistema basat en Oracle.
          Les eines com RMAN i Data Pump permeten adaptar-se a m√∫ltiples escenaris, i una bona estrat√®gia de backup ha d‚Äôestar acompanyada d‚Äôuna pol√≠tica de recuperaci√≥ clara.
        </p>

 <!--        <hr> <h3> Data Guard d'Oracle        </h3> 
        <img src="imgs/dataguard1.png" alt="data guard" style="width: 30%" class="imatge-dreta" >
        <p>Oracle Data Guard √©s una tecnologia d‚ÄôOracle Database que proporciona alta disponibilitat, protecci√≥ de dades i recuperaci√≥ davant desastres (Disaster Recovery).</p>
          <h4>Qu√® fa Data Guard?</h4>
        <p>Data Guard mant√© una o diverses bases de dades en espera (standby) sincronitzades amb la base de dades principal (primary).
          Si la base principal falla, una base de dades standby pot assumir el seu rol i convertir-se en la nova primary, minimitzant 
          el temps d‚Äôinactivitat i la p√®rdua de dades.</p>

          <h4>Components principals</h4>
        <ul>
          <li>Base de dades primary</li>
            <p>-- La que es fa servir habitualment i rep les operacions de lectura i escriptura.</p>
          <li>Bases de dades standby</li>
            <p> -- Physical Standby - C√≤pia exacta a nivell f√≠sic. Aplica els fitxers redo.</p>
            <p> -- Logical Standby  - Utilitza SQL Apply: permet consultes i alguns canvis estructurals.</p>
            <p> -- Snapshot Standby - Standby en mode lectura/escriptura temporal per a proves.</p>
          <li>Redo Transport & Apply</li>
            <p> -- Transporta els fitxers redo des de la primary fins a la standby.</p>
            <p> -- Els aplica per mantindre-les sincronitzades.</p>
        </ul>

        <ol>  <strong>Modes de protecci√≥</strong>
          <li>Maximum Protection -  Sense p√®rdua de dades; requereix confirmaci√≥ de la standby.</li>
          <li>Maximum Availability  -  Sense p√®rdua de dades per√≤ permet que la standby falle temporalment</li>
          <li>Maximum Performance  -  Millor rendiment; pot haver-hi una m√≠nima p√®rdua de dades.</li>
        </ol>

        <ol> <strong>Funcionalitats importants</strong>
          <li>SwitchOver: intercanvi de rols entre primary i standby de manera planificada.</li>
          <li>FailOver: la standby es converteix en primary per una fallada inesperada.</li>
          <li>Gap Resolution: recuperaci√≥ de difer√®ncies entre primary i standby.</li>
          <li>Fast-Start Failover (FSFO): failover autom√†tic mitjan√ßant Data Guard Broker.</li>
        </ol>

        <ol> <strong> Beneficis</strong>
          <li>Alta disponibilitat (HA).</li>
          <li>Recuperaci√≥ davant desastres (DR).</li>
          <li>Protecci√≥ contra corrupci√≥ de dades.</li>
          <li>Reducci√≥ del temps d‚Äôinactivitat.</li>
          <li>Lectures en standby (segons el tipus).</li>
        </ol>

                 -->
      </section>
      

      <section id="normativa-vigent">
        <h2>‚öñÔ∏è Normativa vigent en mat√®ria de protecci√≥ de dades</h2>
      
        <h3>üìò Qu√® √©s la normativa de protecci√≥ de dades?</h3>
        <p>
          √âs el conjunt de lleis i regulacions que tenen com a objectiu <strong>garantir la privadesa i la seguretat de les dades personals</strong> que gestionen les empreses i organitzacions.
          Afecta directament la gesti√≥ dels sistemes d‚Äôinformaci√≥, especialment els que contenen bases de dades amb informaci√≥ de persones f√≠siques.
        </p>
      
        <h3>üá™üá∫ Reglament General de Protecci√≥ de Dades (RGPD)</h3>
        <ul>
          <li><strong>Nom complet:</strong> Reglament (UE) 2016/679 del Parlament Europeu i del Consell</li>
          <li><strong>Aplicaci√≥:</strong> obligat√≤ria a tots els estats membres de la Uni√≥ Europea des del 25 de maig de 2018</li>
          <li><strong>Objectiu:</strong> protegir els drets fonamentals de les persones pel que fa al tractament de les seves dades personals</li>
        </ul>
      
        <h4> Principis b√†sics del RGPD</h4>
        <ul>
          <li> L√≠cit, lleial i transparent</li>
          <li> Finalitat determinada i leg√≠tima</li>
          <li> Minimitzaci√≥ de dades</li>
          <li> Exactitud</li>
          <li> Limitaci√≥ de conservaci√≥</li>
          <li> Integritat i confidencialitat</li>
          <li> Responsabilitat proactiva</li>
        </ul>
      
        <h4>üë• Drets de les persones usu√†ries</h4>
        <ul>
          <li> Dret d‚Äôacc√©s</li>
          <li> Dret de rectificaci√≥</li>
          <li> Dret de supressi√≥ (‚Äúdret a l‚Äôoblit‚Äù)</li>
          <li> Dret d‚Äôoposici√≥</li>
          <li> Dret a la limitaci√≥ del tractament</li>
          <li> Dret a la portabilitat de dades</li>
        </ul>
      
        <h3>üá™üá∏ LOPDGDD ‚Äì Llei org√†nica 3/2018</h3>
        <p>
          A Espanya, la normativa RGPD es complementa amb la LOPDGDD:
        </p>
        <ul>
          <li><strong>Nom complet:</strong> Llei Org√†nica 3/2018 de Protecci√≥ de Dades Personals i garantia dels drets digitals</li>
          <li><strong>Objectiu:</strong> adaptar el RGPD a l‚Äôordenament jur√≠dic espanyol i afegir drets digitals</li>
        </ul>
      
        <h4> Alguns punts destacats de la LOPDGDD</h4>
        <ul>
          <li> Designaci√≥ d‚Äôun Delegat de Protecci√≥ de Dades (DPO) en determinades entitats</li>
          <li> Mesures de seguretat segons el risc de les dades tractades</li>
          <li> Registre d‚Äôactivitats de tractament</li>
          <li> Avaluaci√≥ d‚Äôimpacte quan hi ha risc elevat</li>
          <li> Drets digitals: educaci√≥ digital, neutralitat, desconnexi√≥ laboral, etc.</li>
        </ul>
      
        <h3> Obligacions t√®cniques relacionades amb bases de dades</h3>
        <ul>
          <li> Control d‚Äôacc√©s i permisos per rols</li>
          <li> Auditories d‚Äôacc√©s a dades personals</li>
          <li> Registre de canvis i transaccions</li>
          <li> C√≤pies de seguretat i plans de recuperaci√≥</li>
          <li> Encriptaci√≥ de dades sensibles</li>
        </ul>

        <h3>Drets ARCO</h3>
        <ul>
          <li> Acc√©s</li>
          <li> Rectificaci√≥</li>
          <li> Cancel¬∑laci√≥</li>
          <li> Oposici√≥</li>
        </ul>

        <h3>Paper del SGBD</h3>
        <ul>
            <li> Gesti√≥ d‚Äôusuaris i permisos</li>
            <li>Sistemes de recuperaci√≥</li>
            <li>  RI</li>
            <li>Encriptaci√≥ (informaci√≥ sensible)</li>
            <li>   Auditoria </li>
        </ul>

        <h3>Classificar informaci√≥</h3>
            <ul>
                <li>Nivell b√†sic</li>
                <li> Nivell mig</li>
                <li>Nivell alt </li>
            </ul>
        <h4 style="color:red">Els procediments han d‚Äôestar documentats i supervisats per poder garantir el compliment de la normativa i la llei.</h4>
      
        <h3>üìä Sancions per incompliment</h3>
        <p>
          El RGPD preveu sancions de fins al <strong>4% del volum de negoci anual global</strong> o <strong>20 milions d‚Äôeuros</strong>, segons quina sigui m√©s elevada.
        </p>
      
        <h3> Conclusi√≥</h3>
        <p>
          Tant el <strong>RGPD</strong> com la <strong>LOPDGDD</strong> estableixen un marc normatiu estricte i necessari per protegir les dades personals.
          A l‚Äôhora d‚Äôadministrar bases de dades, cal assegurar-se que:
        </p>
        <ul>
          <li>Les dades sensibles estan ben protegides</li>
          <li>Nom√©s hi accedeix qui est√† autoritzat</li>
          <li>Es poden tra√ßar les operacions sobre dades personals</li>
          <li>Es poden complir els drets dels usuaris</li>
        </ul>
      
        <blockquote>
          ‚öñÔ∏è ‚ÄúUna base de dades segura no nom√©s √©s eficient, sin√≥ tamb√© legalment responsable.‚Äù
        </blockquote>
      </section>

      <section>
        <h1>Informe de bones pr√†ctiques del CCN-CERT</h1>
        <img src="imgs/logo-ccncert.png" alt="ccn-cert" width="25%" class="imatge-dreta">
        <h3> <a href="https://www.ccn-cert.cni.es/es/pdf/informes-de-ciberseguridad-ccn-cert/informes-ccn-cert-buenas-practicas-bp/6257-ccn-cert-bp22-recomendaciones-de-seguridad-para-oracle-database-19c/file.html">
           CCN-CERT BP/22 Recomendaciones de seguridad para Oracle Database 19C         </a>             </h3>
        <p>CCN-CERT BP/22 √©s un document t√®cnic que ofereix recomanacions i bones pr√†ctiques en ciberseguretat, 
          elaborat pel CCN-CERT, amb l‚Äôobjectiu d‚Äôajudar les administracions p√∫bliques i altres organitzacions a millorar 
          la protecci√≥ dels seus sistemes d‚Äôinformaci√≥</p>

      </section>
            



  <section id="altres-recursos">
    <h2>Altres recursos</h2>

    <hr><h3>Rep√†s...</h3>
    <div id="progress-container">
    <div id="progress-bar"></div>  </div>
    <!-- <div id="percentatge-text">0%</div>  -->

    <div class="quiz-container">
        <h4 id="pregunta-text"></h4>
        <div id="options-container" class="options">
        </div>

        <p id="feedback"></p>
        <button id="btn-seguent" onclick="seguentPregunta()">      ‚ûï Seg√ºent pregunta </button>
        <button onclick="carregarPreguntes()">üîÅ Reiniciar</button>


    </div>

    
  </section>
 
 <!--   <section>

    <h2>{ Nova pregunta ===> ‚Ü∫ Recarrega p√†gina ‚Ü∫  o F5  }</h2>
  </section> -->
 
</main>


<script>

    // Per poder copiar codi en el porta-retalls. S'ha de posar un bot√≥ en cada <pre>
    //  <div class="pre-container">
    //    <button class="copy-button">Copia Codi !</button>

  document.addEventListener('DOMContentLoaded', function () {
    const buttons = document.querySelectorAll('.copy-button');

    buttons.forEach(button => {
      button.addEventListener('click', function () {
        const code = this.nextElementSibling.innerText;
        navigator.clipboard.writeText(code).then(() => {
          this.innerText = ' ‚úî Copiat!';
          setTimeout(() => this.innerText = 'Copia Codi !', 3000);
        });
      });
    });
  });

  //  Per fer test final
  // Primer es crea un bancDePreguntes   const
  // i despr√®s es carrega una pregunta aleatoria    function
  // per ultim la funcio de comprobar resposta per a quan es polse un bot√≥

let bancDePreguntes = [];
let preguntesBarrejades = [];
let indexPreguntaActual = 0;
let puntuacio = 0;

function barrejar(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

function actualitzarProgres() {
    const percentatge =
        (indexPreguntaActual / preguntesBarrejades.length) * 100;
    document.getElementById('progress-bar').style.width =
        percentatge + "%";
}

function actualitzarPercentatge() {
    const percentatge = Math.round(
        (puntuacio / preguntesBarrejades.length) * 100
    );
    document.getElementById('percentatge-text').innerText =""
       // `Encerts: üéØ ${percentatge}%`;
}

/*
function carregarPreguntes() {
    fetch('preguntes/preguntes.json')
        .then(response => {
            if (!response.ok) {
                throw new Error("No s'han pogut carregar les preguntes");
            }
            return response.json();
        })
        .then(data => {
            bancDePreguntes = data;
            carregarPreguntaAleatoria();
        })
        .catch(error => {
            console.error(error);
            document.getElementById('pregunta-text').innerText =
                "Error carregant les preguntes üò¢";
        });
}  

function carregarPreguntaAleatoria() {
    // Triar una pregunta a l'atzar
    const indexAleatori = Math.floor(Math.random() * bancDePreguntes.length);
    const pregunta = bancDePreguntes[indexAleatori];

    // Mostrar el t√≠tol
    document.getElementById('pregunta-text').innerText = pregunta.titol;

    // Netejar contenidor de botons
    const container = document.getElementById('options-container');
    container.innerHTML = "";

    // Barrejar opcions (opcional) i crear botons
    pregunta.opcions.forEach(opcio => {
        const btn = document.createElement('button');
        btn.innerText = opcio.text;
        btn.onclick = function() { comprovaResposta(opcio.correcte, btn); };
        container.appendChild(btn);
    });
}*/

function carregarPreguntes() {
    fetch('preguntes/preguntes32.json')
        .then(res => res.json())
        .then(data => {
            bancDePreguntes = data;
            preguntesBarrejades = [...bancDePreguntes];
            barrejar(preguntesBarrejades);
            puntuacio = 0;
            indexPreguntaActual = 0;
            mostrarPregunta();
        })
        .catch(err => {
            console.error(err);
            document.getElementById('pregunta-text').innerText =
                "Error carregant les preguntes üò¢";
        });
        //document.getElementById('percentatge-text').innerText = "0%";

}

function mostrarPregunta() {

    // Si ja no queden preguntes
    if (indexPreguntaActual >= preguntesBarrejades.length) {
        document.getElementById('pregunta-text').innerText =
            "üéâ Has acabat totes les preguntes!";
        document.getElementById('options-container').innerHTML = "";
        document.getElementById('feedback').innerHTML =
        `Has encertat <strong>${puntuacio}</strong> de 
        <strong>${preguntesBarrejades.length}</strong> preguntes.`;
        document.getElementById('btn-seguent').disabled = true;
        document.getElementById('progress-bar').style.width = "100%";
        actualitzarProgres();
        return;
    }

    const pregunta = preguntesBarrejades[indexPreguntaActual];

    document.getElementById('pregunta-text').innerText = pregunta.titol;

    const container = document.getElementById('options-container');
    container.innerHTML = "";

    pregunta.opcions.forEach(opcio => {
        const btn = document.createElement('button');
        btn.innerText = opcio.text;
        btn.onclick = () => comprovaResposta(opcio.correcte, btn);
        container.appendChild(btn);
    });

    document.getElementById('feedback').textContent = "";
    document.getElementById('btn-seguent').disabled = true;
    actualitzarProgres();

}


  /*  function comprovaResposta(esCorrecte, element) {
        const feedback = document.getElementById('feedback');
        
        // Reset de colors dels botons
        const botons = document.querySelectorAll('button');
        botons.forEach(btn => btn.style.background = "#fff");

        if (esCorrecte) {
            feedback.textContent = "‚úÖ Correcte! Molt b√©.";
            feedback.className = "correct";
            element.style.background = "#d4edda"; // Verd clar
        } else {
            feedback.textContent = "‚ùå Incorrecte. Torna-ho a provar.";
            feedback.className = "incorrect";
            element.style.background = "#f8d7da"; // Vermell clar
        }
    }
    
  function seguentPregunta() {
    carregarPreguntaAleatoria();
}*/

function comprovaResposta(esCorrecte, element) {
    const feedback = document.getElementById('feedback');

    document
        .querySelectorAll('#options-container button')
        .forEach(btn => btn.disabled = true);

    if (esCorrecte) {
        feedback.textContent = "‚úÖ Correcte! Molt b√©.";
        element.style.background = "#d4edda";
        puntuacio++;
    } else {
        feedback.textContent = "‚ùå Incorrecte.";
        element.style.background = "#f8d7da";
    }
    //actualitzarPercentatge();
    document.getElementById('btn-seguent').disabled = false;
}

function seguentPregunta() {
    indexPreguntaActual++;
    mostrarPregunta();
}

  

// Executar en carregar la p√†gina
window.onload = carregarPreguntes;
// antes   window.onload = carregarPreguntaAleatoria;

</script>

</body>
</html>
